//BillCollectionYearlyReport



select Distinct year(col.receipt_dt)as year,monthName(col.receipt_dt) as month,D.DIVISION_NAME AS DNAME,T.TARIFF_CATEGORY  AS CATEGORY,
COL.CAN AS CAN ,col.receipt_mode as Payment, RECEIPT_DT,'From Date','To Date',SUM(COL.RECEIPT_AMT)AS Amount
from CUST_DETAILS C JOIN DIVISION_MASTER D ON C.DIVISION_MASTER_ID=D.ID JOIN TARIFF_CATEGORY_MASTER T  ON C.TARIFF_CATEGORY_MASTER_ID=T.ID
JOIN COLL_DETAILS COL ON C.CAN=COL.CAN WHERE C.DIVISION_MASTER_ID=$P{dmaId} AND TARIFF_CATEGORY_MASTER_ID=$P{categoryId} AND year(col.receipt_dt)=$P{year} and
monthName(col.receipt_dt)=$P{month}
group by can