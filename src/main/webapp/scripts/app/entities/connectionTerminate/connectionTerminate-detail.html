
<div>
	<h2>
		<span>ConnectionTerminate</span> {{connectionTerminate.id}}
	</h2>
	<div class="panel panel-primary">
		<div class="panel-heading clearfix">
			<h3 class="panel-title pull-left">Requests</h3>
		</div>
		<div class="list-group">
			<div class="table-responsive">
				<table class="clickableTable table table-striped">
					<thead>
						<tr>
							<th>From</th>
							<th>To</th>
							<th>Remarks</th>
							<th>Actioned Date</th>
							<th>IP Address</th>
							<th>Status</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="item in requestWorkflowHistorys">
							<td>{{item.assignedFrom.firstName}}
								{{item.assignedFrom.lastName}} ({{item.assignedFrom.login}})</td>
							<td>{{item.assignedTo.firstName}}
								{{item.assignedTo.lastName}} ({{item.assignedTo.login}})</td>
							<td>{{item.remarks}}</td>
							<td>{{item.actionedDate | date:'mediumDate'}}</td>
							<td>{{item.ipAddress}}</td>
							<td>{{item.statusMaster.status}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	<div class="panel panel-primary">
		<div class="panel-heading clearfix">
			<h3 class="panel-title pull-left">Connection Termination</h3>
		</div>
		<div class="list-group">
			<div class="list-group-item">
				<fieldset ng-if="custDetails.can">
					<legend>Customer Information for CAN : {{custDetails.can}}</legend>
					<div class="row">
						<div class="col-sm-3">
							<label class="control-label" for="field_consName">Consumer
								Name</label>
							<h5 class="list-group-item-heading">{{custDetails.consName}}</h5>
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_can">Dues</label>
							<h5 class="list-group-item-heading">{{custDetails.arrears |
								number :2}}</h5>
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_category">Category</label>
							<h5 class="list-group-item-heading">{{custDetails.tariffCategoryMaster.tariffCategory}}</h5>
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_meterDetails">Meter
								No. </label>
							<h5 class="list-group-item-heading">{{custDetails.meterDetails.meterNo}}</h5>
						</div>
					</div>
					<br>
					<div class="row">
						<div class="col-sm-3">
							<label class="control-label" for="field_mobileNo">Mobile
								No.</label>
							<h5 class="list-group-item-heading">{{custDetails.mobileNo}}</h5>
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_email">E-mail
								Address</label>
							<h5 class="list-group-item-heading">{{custDetails.email}}</h5>
						</div>
						<div class="col-sm-3">
							<label for="field_divisionMaster">DMA</label>
							<h5 class="list-group-item-heading">{{custDetails.divisionMaster.divisionName}}</h5>
						</div>
						<div class="col-sm-3">
							<label for="field_streetMaster">Street</label>
							<h5 class="list-group-item-heading">{{custDetails.streetMaster.streetName}}</h5>
						</div>
					</div>
					<br>
					<div class="row">
						<div class="col-sm-3">
							<label class="control-label" for="field_houseNo">House
								No./Plot No.</label>
							<h5 class="list-group-item-heading">{{custDetails.houseNo}}</h5>
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_city">City</label>
							<h5 class="list-group-item-heading">{{custDetails.city}}</h5>
						</div>
						<div class="col-sm-6">
							<label class="control-label" for="field_address">Address
								Detail</label>
							<h5 class="list-group-item-heading">{{custDetails.address}}</h5>
						</div>
					</div>
				</fieldset>
				<br>
				<fieldset>
					<legend>Request Details</legend>
					<div class="row">
						<div class="col-sm-3">
							<label>Requested Date</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.requestDate
								| date:'mediumDate'}}</h5>
						</div>
						<div class="col-sm-3">
							<label>Termination Type</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.terminationType}}</h5>
						</div>
						<div class="col-sm-6">
							<label>Reason</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.reason}}</h5>
						</div>
					</div>
				</fieldset>
				<fieldset ng-show="connectionTerminate.meterRecovered === true">
					<legend>Meter Info.</legend>
					<div class="row">
						<div class="col-sm-3">
							<label>Meter Recovered</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.meterRecovered===0?'NOT
								RECOVERED':'YES RECOVERED'}}</h5>
						</div>
						<div class="col-sm-3">
							<label>Recovered Date</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.meterRecoveredDate
								| date:'mediumDate'}}</h5>
						</div>
						<div class="col-sm-3">
							<label>Last Meter Reading</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.lastMeterReading}}</h5>
						</div>
						<div class="col-sm-3">
							<label>Meter Condition</label>
							<h5 class="list-group-item-heading">{{connectionTerminate.meterCondition}}</h5>
						</div>
					</div>
				</fieldset>
				<br>
				<fieldset
					ng-show="orgRole.id === 14 && connectionTerminate.meteredConnection === true && connectionTerminate.status != 'TERMINATED'">
					<legend>Meter Info.</legend>
					<div class="row">
						<div class="col-sm-3">
							<label class="control-label" for="field_meterRecovered">Meter
								Recovered</label>
							<div class="radio">
								<label class="radio-inline"> <input type="radio"
									name="meterRecovered"
									ng-model="connectionTerminate.meterRecovered" ng-value="true">Yes
								</label> &nbsp;&nbsp;&nbsp;&nbsp;<label class="radio-inline"> <input
									type="radio" name="meterRecovered"
									ng-model="changeCaseDTO.connectionTerminate.meterRecovered"
									ng-value="false">No
								</label>
							</div>
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_lastMeterReading">Last
								Billed Reading</label> <input type="number" class="form-control"
								name="lastBilledReading" id="field_lastBilledReading"
								ng-model="custDetails.prevReading" disabled />
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_lastMeterReading">Final
								Meter Reading</label> <input type="number" class="form-control"
								name="lastMeterReading" id="field_lastMeterReading"
								ng-disabled="changeCaseDTO.connectionTerminate.meterRecovered==false"
								ng-model="changeCaseDTO.connectionTerminate.lastMeterReading"
								ng-blur="checkReading(custDetails.prevReading, custDetails.prevReading)" />
						</div>
						<div class="col-sm-3">
							<label class="control-label" for="field_meterRecoveredDate">Meter
								Recovered Date</label>
							<div class="form-group">
								<div class='input-group date' id='field_meterRecoveredDate'>
									<input id="field_meterRecoveredDate" type="text"
										class="form-control" uib-datepicker-popup="{{dateformat}}"
										ng-model="changeCaseDTO.connectionTerminate.meterRecoveredDate"
										max-date="maxDt"
										ng-disabled="changeCaseDTO.connectionTerminate.meterRecovered==false"
										is-open="datePickerForMeterRecoveredDate.status.opened" /> <span
										class="input-group-btn">
										<button type="button" class="btn btn-default"
											ng-click="datePickerForMeterRecoveredDateOpen($event)"
											ng-disabled="changeCaseDTO.connectionTerminate.meterRecovered==false">
											<i class="glyphicon glyphicon-calendar"></i>
										</button>
									</span>
								</div>
							</div>
						</div>

					</div>
					<div class="row">
						<div class="col-sm-3">
							<label class="control-label" for="field_meterCondition">Meter Condition</label> 
							<select class="form-control" name="meterCondition"
								ng-model="connectionTerminate.meterCondition"
								ng-disabled="changeCaseDTO.connectionTerminate.meterRecovered==false"
								id="field_meterCondition">
								<option value="WORKING">WORKING</option>
								<option value="FAULT">FAULT</option>
							</select>
						</div>
					</div>
				</fieldset>
				<hr>
				<fieldset ng-show="user.login === requestAt && requestStatus === 3">
					<legend>Approval Details</legend>
					<div class="row">
						<div class="col-sm-3">
							<label class="control-label" for="field_approvedDate">Approved
								Date</label>
							<div class="form-group">
								<div class='input-group date' id='field_approvedDate'>
									<input id="field_approvedDate" type="text" class="form-control"
										uib-datepicker-popup="{{dateformat}}"
										ng-model="changeCaseDTO.approvedDate" max-date="maxDt"
										is-open="datePickerForApprovedDate.status.opened" /> <span
										class="input-group-btn">
										<button type="button" class="btn btn-default"
											ng-click="datePickerForApprovedDateOpen($event)">
											<i class="glyphicon glyphicon-calendar"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
						<div class="col-sm-6">
							<label class="control-label" for="field_remarks">Remarks</label>
							<textarea rows="2" cols="50" class="form-control" name="remarks"
								style="resize: none" id="field_remarks" max="20"
								ng-model="changeCaseDTO.remarks"></textarea>
						</div>
					</div>
				</fieldset>

			</div>
		</div>
	</div>
	<button type="button" class="btn btn-success pull-right"
		ng-show="user.login === requestAt && requestStatus === 3"
		ng-click="approve(changeCaseDTO)">
		<span class="glyphicon glyphicon-check"></span> &nbsp;Approve
	</button>

	<span class="pull-right">&nbsp;&nbsp;&nbsp;</span>

	<button type="button" class="btn btn-danger pull-right"
		ng-show="user.login === requestAt && requestStatus === 3"
		ng-disabled="isSaving" ng-click="declineRequest(changeCaseDTO)">
		<span class="glyphicon glyphicon-remove-circle"></span> &nbsp;Decline
	</button>
	<button type="submit" onclick="window.history.back()"
		class="btn btn-info">
		<span class="glyphicon glyphicon-arrow-left"></span>&nbsp;<span>
			Back</span>
	</button>
</div>
